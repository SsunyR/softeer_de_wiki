# 0814 강의

## Too Big for Memory, Caching Rules(Strategy)

- Spark에 대해 이해하기 위해서는 in-memory 라는 단어를 잠시 버려야 한다.
- Storage Memory는 평소엔 사용되지 않음. Caching 시에만 일어남.
- Execution Memory가 다 차면 (Execution Memory -> Storage Memory) eviction이 일어남. 기존 mem은 LRU에 따라 처리.
  - LRU는 cache()/persist() 시에만 일어난다.
- 작고 많은 계산은 MEMORY_ONLY / 여러번 하기 부담스러운 계산은 MEMORY_AND_DISK
- 캐싱 전략은 결국 데이터 모양 따라 최적의 파티션 개수를 결정해야 한다(파티션의 사이즈를 조절해야 한다).
  - job은 항상 partition 단위로 일어나기 때문.
- caching은 spark에서 정말 잘 써야함.
  - spill을 잘 추적

- Data Skew는 분산처리에서 가장 처리해야할 문제.

- join, sort 시에만 storage memory?

### off-heap